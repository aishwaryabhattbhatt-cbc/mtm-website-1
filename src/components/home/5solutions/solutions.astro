---
/* src/components/home/5-solutions/solutions.astro */
import './solutions.css';
import RoleButton from '../../home/5solutions/RoleButton.astro';
import { solutionsData } from './solutions.js'; // Import data for HTML

const { content } = Astro.props;

// Merge CSV text with existing hardcoded asset paths (icons/logos)
const mergedData = solutionsData.map(hardcoded => {
  const csvMatch = content.roles.find(r => r.id === hardcoded.id);
  return {
    ...hardcoded,
    description: csvMatch?.desc || hardcoded.description,
    ctaLabel: csvMatch?.cta || hardcoded.ctaLabel
  };
});

const activeRole = mergedData.find(role => role.id === "media") || mergedData[0]; 
// const activeRole = solutionsData.find(role => role.id === "media") || solutionsData[0];

---

<section class="section-solutions">
  <div class="page-inner solutions-container">
    
    {/* Header Block */}
<div class="solutions-header">
    <h2 class="h2">
      <span class="hl-text highlight-2">{content.titleHighlight}</span>
      <span class="title-base">{content.titleBase}</span>
    </h2>
    
    <p class="body-m solutions-desc">{content.description}</p>
</div>

    {/* New Solutions Roles Block */}
    <div class="solutions-roles">
      
        {/* 1. Roles Block */}
          <div class="role-buttons">
            {solutionsData.map((role) => (
            <RoleButton
            id={role.id}
            label={role.label}
            icon={role.icon}
            isActive={role.id === "media"} // 'Media' is default active
            />
            ))}
            </div>
            
        {/* 2. Text + Button Block */}
        <div class="board-cta">
          <p class="body-l role-description">{activeRole.description}</p>
          <a href={`/solutions/${activeRole.id}`} class="btn-tertiary button-l">{activeRole.ctaLabel}</a>
        </div>
  </div>

  {/* 3. Clients Block */}
  <div class="board-clients">
    <div class="logo-strip">
      <img src={activeRole.clientLogos} alt="Trusted Clients" id="client-logo-image" class="client-image" />
    </div>
  </div>
</div>
</section>


<script is:inline define:vars={{ mergedData }}>
  window.solutionsData = mergedData;
</script>

<script>
    import { initSolutionsBoard } from './rolebutton.js';
    
    document.addEventListener('DOMContentLoaded', () => {
      // Use the CSV-enhanced data from the window 
      if ((window as any).solutionsData) {
        initSolutionsBoard((window as any).solutionsData);
      }
    });
</script>