---
/* src/components/ui/Percentage/percentage.astro */
import "./percentage.css";

const {
  percent = 0,    // The progress value (0-100)
  size = 48,       // Diameter of the component in pixels
  stroke = 6,      // Thickness of the rings
  ariaLabel = "Percentage",
} = Astro.props;

// Ensure percent stays between 0 and 100
const pct = Math.max(0, Math.min(100, Number(percent) || 0));

// SVG Geometry Math
const half = size / 2;
const radius = (size - stroke) / 2;
const circumference = 2 * Math.PI * radius;
const dashOffset = circumference * (1 - pct / 100);
---

<div 
  class="percentage-container" 
  style={`--pct-size: ${size}px; --pct-stroke: ${stroke}px;`}
  aria-label={ariaLabel}
>
  <svg
    class="percentage__svg"
    width={size}
    height={size}
    viewBox={`0 0 ${size} ${size}`} 
    role="img"
  >
    <circle
      class="percentage__ring percentage__ring--bg"
      cx={half}
      cy={half}
      r={radius}
      fill="none"
      stroke-width={stroke}
    />

    <circle
      class="percentage__ring percentage__ring--fg"
      cx={half}
      cy={half}
      r={radius}
      fill="none"
      stroke-width={stroke}
      stroke-dasharray={circumference}
      stroke-dashoffset={dashOffset}
      stroke-linecap="round"
    />
  </svg>

  <span class="percentage__text body-s">{pct}%</span>
</div>